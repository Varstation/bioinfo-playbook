<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/bioinfo-playbook/blog/rss.xml" title="Guia de Boas Pr√°ticas para Bioinform√°tica Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/bioinfo-playbook/blog/atom.xml" title="Guia de Boas Pr√°ticas para Bioinform√°tica Blog Atom Feed"><title data-react-helmet="true">Construindo seu primeiro pipeline | Guia de Boas Pr√°ticas para Bioinform√°tica</title><meta data-react-helmet="true" property="og:url" content="https://varstation.github.io//bioinfo-playbook/docs/guide-develop/writing-wdl"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Construindo seu primeiro pipeline | Guia de Boas Pr√°ticas para Bioinform√°tica"><meta data-react-helmet="true" name="description" content="Nesta se√ß√£o iremos apresentar como construir seu primeiro pipeline em WDL. Neste pipeline vamos passar pelas etapas b√°sicas e comuns em um pipeline de detec√ß√£o de variantes SNVs (de um √∫nico nucleot√≠deo) ou pequenas indels (inser√ß√µes e dele√ß√µes). Este exemplo permitir√° que voc√™ consiga j√° familiridade com as ferramentas de bioinform√°tica e a linguagem de cria√ß√£o de workflows WDL. Esta ferramenta aqui executa a descoberta de variantes em dados de sequenciamento de nova gera√ß√£o (NGS)."><meta data-react-helmet="true" property="og:description" content="Nesta se√ß√£o iremos apresentar como construir seu primeiro pipeline em WDL. Neste pipeline vamos passar pelas etapas b√°sicas e comuns em um pipeline de detec√ß√£o de variantes SNVs (de um √∫nico nucleot√≠deo) ou pequenas indels (inser√ß√µes e dele√ß√µes). Este exemplo permitir√° que voc√™ consiga j√° familiridade com as ferramentas de bioinform√°tica e a linguagem de cria√ß√£o de workflows WDL. Esta ferramenta aqui executa a descoberta de variantes em dados de sequenciamento de nova gera√ß√£o (NGS)."><link data-react-helmet="true" rel="shortcut icon" href="/bioinfo-playbook/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://varstation.github.io//bioinfo-playbook/docs/guide-develop/writing-wdl"><link data-react-helmet="true" rel="alternate" href="https://varstation.github.io//bioinfo-playbook/docs/guide-develop/writing-wdl" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://varstation.github.io//bioinfo-playbook/docs/guide-develop/writing-wdl" hreflang="x-default"><link rel="stylesheet" href="/bioinfo-playbook/assets/css/styles.0d0d612a.css">
<link rel="preload" href="/bioinfo-playbook/assets/js/runtime~main.fac7ff84.js" as="script">
<link rel="preload" href="/bioinfo-playbook/assets/js/main.4b2ff57c.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/bioinfo-playbook/"><img src="/bioinfo-playbook/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/bioinfo-playbook/img/logo.svg" alt="My Site Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><b class="navbar__title">Guidelines Bioinform√°tica</b></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link navbar__link--active" href="/bioinfo-playbook/docs/get-started">Documenta√ß√£o</a><a class="navbar__item navbar__link" href="/bioinfo-playbook/blog">Blog</a><a href="https://github.com/varstation/bioinfo-playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" aria-label="GitHub repository"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="react-toggle toggle_3Zt9 react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_71bT">üåú</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">üåû</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_31aa"><button class="clean-btn backToTopButton_35hR" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed menuWithAnnouncementBar_2WvA"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/bioinfo-playbook/docs/get-started">Seja bem vindo ao Playboook de Bioinform√°tica do Varstation</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Como executar um pipeline</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Como construir ou melhorar seu pipeline</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/bioinfo-playbook/docs/guide-develop/checklist">Construindo ou melhorando seu pipeline em WDL</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/bioinfo-playbook/docs/guide-develop/writing-wdl">Construindo seu primeiro pipeline</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/bioinfo-playbook/docs/guide-develop/running-wdl">Executando seu pipeline</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/bioinfo-playbook/docs/guide-develop/results-wdl">Verificando os resultados</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/bioinfo-playbook/docs/guide-develop/deploy-wdl">Preparando para deploy</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/bioinfo-playbook/docs/guide-develop/deploy-your-site">Deploy your site</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/bioinfo-playbook/docs/guide-develop/congratulations">Congratulations!</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Ciclo de desenvolvimento e boas pr√°ticas</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Como contribuir</a></li></ul></nav></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_27L5">Construindo seu primeiro pipeline</h1></header><p>Nesta se√ß√£o iremos apresentar como construir seu primeiro pipeline em WDL. Neste pipeline vamos passar pelas etapas b√°sicas e comuns em um pipeline de detec√ß√£o de variantes SNVs (de um √∫nico nucleot√≠deo) ou pequenas indels (inser√ß√µes e dele√ß√µes). Este exemplo permitir√° que voc√™ consiga j√° familiridade com as ferramentas de bioinform√°tica e a linguagem de cria√ß√£o de workflows WDL. Esta ferramenta aqui executa a descoberta de variantes em dados de sequenciamento de nova gera√ß√£o (NGS).</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>Este tutorial assume que voc√™ tenha o conhecimento b√°sico de ferramentas como BWA (alinhamento) e Freebayes (chamador de variantes) e ter lido j√° nosso guia de in√≠cio de desenvolvimento. Voc√™ deve ter tamb√©m todas as ferramentas necess√°rias para instala√ß√£o e ter acesso aos dados que este tutorial ir√° utilizar. Para fins de exemplo, iremos usar uma amostra humana sint√©tica com regi√µes dos cromossomos 13 e 17, cujas sequ√™ncias pertencem  a alguns genes como BRCA1 e BRCA2.</p></div></div><p><img src="/bioinfo-playbook/assets/images/pipeline-germline-dna-baf95621b265263e57796c478679e470.png"></p><p>Como podemos visualizar no diagrama acima, n√≥s teremos quatro tarefas principais, a task ValidateInputs, respons√°vel por validar os arquivos FASTQs ,  a task Merge, que ir√° realizar a opera√ß√£o de combina√ß√£o (merge) dos fastqs seguindo o padr√£o R1 ou R2,  a task BwaMem que ir√° receber um par de arquivos Fastqs (Files) e ir√° produzir como sa√≠da um arquivo BAM com os alinhamentos. Na √∫ltima task  Freebayes, ir√° receber o arquivo BAM do sa√≠da da etapa anterior e ir√° produzir o arquivo de sa√≠da rawVCF. Ser√° um pipeline com apenas quatro tasks: valida√ß√£o, merge alinhamento e chamada de variantes. O foco aqui ser√° em detec√ß√£o de variantes germinativas.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>Geralmente muta√ß√µes som√°ticas e muta√ß√µes germinativas necessitam de tratamento e an√°lise de dados espec√≠ficos, o que resulta em diferentes pipelines de bioinform√°tica. As muta√ß√µes germinativas s√£o aquelas que conferem predisposi√ß√£o, em alguns casos elevada, de desenvolver tumores e esses tumores no geral t√™m uma agrega√ß√£o familiar. A presen√ßa de uma muta√ß√£o germinativa pode ter implica√ß√£o no tratamento, mas isso n√£o √© frequente. Um exemplo s√£o os tumores de mama e ov√°rio com muta√ß√µes nos genes BRCA 1 e 2. J√° as muta√ß√µes som√°ticas est√£o casualmente associadas com a transforma√ß√£o maligna e progress√£o da doen√ßa e a detec√ß√£o dessas muta√ß√µes pode guiar a escolha terap√™utica.</p></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="construindo-o-workflow"></a>Construindo o Workflow<a class="hash-link" href="#construindo-o-workflow" title="Direct link to heading">#</a></h3><p>Primeiro passo √© construir o workflow. O workflow √© a linha principal onde todas as tarefas s√£o chamadas na ordem sequencial. Neste caso temos quatro tasks, Validate, Merge, Alignment e Varcall. No trecho de c√≥digo abaixo declaramos o workflow e invocamos as respectivas tasks:</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;wdl-tasks/validate-inputs.wdl&quot; as validate</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;wdl-structs/structs.wdl&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;merge.wdl&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;alignment.wdl&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">import &quot;varcall.wdl&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">workflow GermlineVarcallDna {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  input {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        SampleInputs sampleInputs</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        BwaIndex  bwaIndex</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Int bwaThreads = 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        File reference</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        File reference_idx</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        File ? intervals</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    call validate.ValidateInputs {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        input:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            sampleName = sampleInputs.sampleName,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            fastqs1 = sampleInputs.fastqs1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            fastqs2 = sampleInputs.fastqs2,</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    if (defined(sampleInputs.fastqs1) &amp;&amp; defined(sampleInputs.fastqs2)) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Array[File] fastqs1 = select_first([sampleInputs.fastqs1])</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Array[File] fastqs2 = select_first([sampleInputs.fastqs2])</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        String outputPrefix = sub(basename(fastqs1[0]), &quot;_L001_R1_001.fastq.gz&quot;, &quot;&quot;)</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        call merge.Merge {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            input:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                readsToMergeFwd = fastqs1,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                readsToMergeRev = fastqs2,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                outputPrefix = outputPrefix</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        call alignment.BwaMem {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            input:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                read1 = Merge.trimmedReadsFwd,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                read2 = Merge.trimmedReadsRev,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                bwaIndex  = bwaIndex,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                outputPrefix = outputPrefix,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                threads = bwaThreads,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                memoryGb = 4</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        call varcall.FreeBayes {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            input:</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                reference = reference,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                reference_idx = reference_idx,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                intervals  = intervals,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                outputPrefix = outputPrefix,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                bam_file = BwaMem.outputBam,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                bam_idx_file = BwaMem.outputBai</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Para cada task invocada do workflow definimos os inputs que s√£o as entradas exigidas para cada chamada da task, como um pipeline de blocos em que a sa√≠da de um bloco serve como entrada do pr√≥ximo bloco , e assim sucessivamente.</p><p><img src="/bioinfo-playbook/assets/images/linear-chaining-185929e3597443534801fd4bd69d093c.png"></p><p>Agora, vamos construir as respectivas tasks.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="construindo-as-tasks"></a>Construindo as tasks<a class="hash-link" href="#construindo-as-tasks" title="Direct link to heading">#</a></h3><p>A task √© essencialmente um componente que inclui um ou mais comandos necess√°rios para execu√ß√£o da tarefa. Esta √© interpretada pelo orquestrador e executada como se estiv√©ssemos executando em linha de comando pelo terminal. Para entendermos como escrever em WDL, geralmente constru√≠mos toda a invoca√ß√£o do comando fora do WDL, testamos e depois literalmente copiamos o comando para a nossa task e mapeamos os inputs (entradas) e sa√≠das (outputs).</p><p>Como s√£o v√°rias tasks, vamos pegar uma de exemplo para vermos a sintaxe e arquitetura. Vamos utilizar como refer√™ncia a Freebayes, respons√°vel pela chamada de variantes.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="freebayes"></a>FreeBayes<a class="hash-link" href="#freebayes" title="Direct link to heading">#</a></h4><p><img src="data:image/png;base64,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"></p><p>Come√ßamos sempre pelo comando que ir√° ser executado pela task, no nosso exemplo a seguir, vemos que o comando freebayes solicita alguns arquivos de entrada como o reference.fasta, o input bam_file, o arquivo de sa√≠da output_filename e finalmente o comando freebayes. Para cada entrada desta n√≥s declaramos uma vari√°vel de entrada. Algumas delas ir√£o vir a partir de inputs externos e outras ser√£o declaradas internamente.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">task FreeBayes {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  command {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    set -Eeuxo pipefail;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    test -f ~{bam_idx_file}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    freebayes \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      -f ~{reference} \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ~{&quot;-t &quot; + intervals} \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ~{bam_file} \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ~{userString} \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      -v ~{output_filename};</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Abaixo algumas vari√°veis declaradas em nosso arquivo de tasks, cada uma delas tem um tipo String, File , Float e Int e determinam como o interpretador ir√° avaliar cada uma delas no momento da execu√ß√£o. O mesmo √© v√°lido para o output de sa√≠da, que em nostro exemplo √© um arquivo vcf, que ser√° o arquivo o qual o comando ir√° escrever ap√≥s sua conclus√£o. Para plugar as vari√°veis ao comando , basta usar a sintaxe <code>~{variablename}</code>.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">task FreeBayes {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  input {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    File reference</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    File reference_idx</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    File ? intervals</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    String outputPrefix</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    File bam_file</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    File bam_idx_file</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    String userString = &quot;-4 -q 15 -F 0.03&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Float memory = 12</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Int cpu = 1</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    String output_filename = outputPrefix + &#x27;.freebayes.vcf&#x27;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    String dockerImage = &quot;quay.io/biocontainers/freebayes:1.3.2--py37hc088bd4_0&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  command {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    set -Eeuxo pipefail;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    test -f ~{bam_idx_file}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    freebayes \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      -f ~{reference} \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ~{&quot;-t &quot; + intervals} \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ~{bam_file} \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      ~{userString} \</span></span><span class="token-line" style="color:#393A34"><span class="token plain">      -v ~{output_filename};</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  output {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    File vcf_file = &quot;~{output_filename}&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>Estamos quase l√°, agora definimos algumas configura√ß√µes de como o pipeline ir√° executar com as configura√ß√µes de runtime e para a documenta√ß√£o definimos os metadados das vari√°veis de entrada e sa√≠da pelo componente <code>parameters_meta</code>, um JSOn contendo uma breve descri√ß√£o das vari√°veis e se as mesmsas s√£o obrigat√≥rias ou opcionais.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly"><pre tabindex="0" class="prism-code language-undefined codeBlock_23N8 thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_39YC"><span class="token-line" style="color:#393A34"><span class="token plain">task FreeBayes {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  input {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  command {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  output {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    ...</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  runtime {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    memory: memory + &quot; GB&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    cpu: cpu</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    docker: dockerImage</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  parameter_meta {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        reference: {description:&quot;Reference sequence file.&quot;, category: &quot;required&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        reference_idx: {description: &quot;Reference sequence index (.fai).&quot;, category: &quot;required&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        intervals: {description: &quot;One or more genomic intervals over which to operate.&quot;, category: &quot;required&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        bam_file: {description: &quot;Sorted BAM file.&quot;, category: &quot;required&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        bam_idx_file: {description: &quot;Sorted BAM index file.&quot;, category: &quot;required&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        output_filename: {description: &quot;VCF output file name Default is prefix + vcf.&quot;, category: &quot;common&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        userString: {description: &quot;An optional parameter which allows the user to specify additions to the command line at run time.&quot;, category: &quot;common&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        memory: {description: &quot;GB of RAM to use at runtime.&quot;, category: &quot;advanced&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        cpu: {description: &quot;Number of CPUs to use at runtime.&quot;, category: &quot;advanced&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        dockerImage: {description: &quot;Docker image for running the varcaller.&quot;, category: &quot;advanced&quot;}</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o clean-btn">Copy</button></div></div><p>O Cromwell permite a utiliza√ß√£o de imagens <a href="https://cromwell.readthedocs.io/en/stable/tutorials/Containers/" target="_blank" rel="noopener noreferrer">Docker</a> para instancia√ß√£o das suas ferramentas no momento da execu√ß√£o, isto facilita muito a velocidade do pipeline, j√° que o Docker prov√™ ferramentas que abstraem todo o processo de instala√ß√£o e setup de cada ferramenta. No exemplo acima j√° utilizamos uma imagem pr√©via armazenada em um reposit√≥rio de imagens Docker contendo a imagem do Freebayes.</p><p><img src="/bioinfo-playbook/assets/images/docker-wdl-36615277dc2bcb7f34cfafe55d426f8d.png"></p><p>Na pr√≥xima se√ß√£o vamos aprender como executar o nosso primeiro pipeline em WDL e verificar os resultados.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/varstation/bioinfo-playbook/edit/master/website/docs/guide-develop/writing-wdl.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_3DPF"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/bioinfo-playbook/docs/guide-develop/checklist"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">¬´ Construindo ou melhorando seu pipeline em WDL</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/bioinfo-playbook/docs/guide-develop/running-wdl"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Executando seu pipeline ¬ª</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#construindo-o-workflow" class="table-of-contents__link">Construindo o Workflow</a></li><li><a href="#construindo-as-tasks" class="table-of-contents__link">Construindo as tasks</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/bioinfo-playbook/docs/get-started">Comece agora</a></li></ul></div><div class="col footer__col"><div class="footer__title">Nossas Diretrizes</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/bioinfo-playbook/docs/contribution/README">Como contribuir</a></li><li class="footer__item"><a class="footer__link-item" href="/bioinfo-playbook/privacy">Privacidade</a></li></ul></div><div class="col footer__col"><div class="footer__title">Extras</div><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/bioinfo-playbook/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/varstation/bioinfo-playbook/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item">Changelogs</a></li><li class="footer__item"><a href="https://github.com/varstation/bioinfo-playbook" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright ¬© 2021 Varstation & Hospital Israelita Albert Einstein, Built with Docusaurus.</div></div></div></footer></div>
<script src="/bioinfo-playbook/assets/js/runtime~main.fac7ff84.js"></script>
<script src="/bioinfo-playbook/assets/js/main.4b2ff57c.js"></script>
</body>
</html>